version: "3.8"

services:
  belle-ai-service:
    image: belle_ai_belle-ai-service:fix-redis
    container_name: belle-ai-service
    restart: unless-stopped

    network_mode: "host"

    env_file:
      - .env
    environment:
      DATABASE_URL: ${DATABASE_URL}
      REDIS_URL: ${REDIS_URL}
      LOG_DIR: /app/logs
      TZ: Asia/Shanghai

    volumes:
      - /data/belle_ai/logs:/app/logs

    # ✅ 强制用 uvicorn 启动（覆盖掉你 commit 进去的 bash）
    command: ["uvicorn", "app.main:app", "--host", "0.0.0.0", "--port", "8000"]
